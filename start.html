<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";
  
  const firebaseConfig = {
    apiKey: "AIzaSyC70g8YdB4FvcnfnnLvnQKnxZvR8kYziXM",
    authDomain: "heartland-se.firebaseapp.com",
    projectId: "heartland-se",
    storageBucket: "heartland-se.appspot.com",
    messagingSenderId: "517981430157",
    appId: "1:517981430157:web:944816b509428f859f9dc4",
    measurementId: "G-905K6LQJ3L"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // 2) Recover userID (URL param → localStorage)
  const params = new URLSearchParams(window.location.search);
  let userID = params.get('userID') || localStorage.getItem('huntUserID');
  if (!userID) {
    alert('No userID—please register first.');
    window.location.href = 'index.html';
  } else {
    localStorage.setItem('huntUserID', userID);
  }

  import { doc, getDoc } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";

  async function fetchUserStatus() {
    try {
      const docRef = doc(db, "users", userID);
      const docSnap = await getDoc(docRef);
      if (!docSnap.exists()) {
        alert("User data not found.");
        return;
      }
      const data = docSnap.data();

      // Mark complete if true
      if (data.stationA) document.getElementById('hintA').classList.add('complete');
      if (data.stationB) document.getElementById('hintB').classList.add('complete');
      if (data.stationC) document.getElementById('hintC').classList.add('complete');
      if (data.stationV) document.getElementById('hintV').classList.add('complete');

    } catch (err) {
      console.error(err);
      alert('Could not load your status: ' + err);
    }
  }

  fetchUserStatus();

</script>
